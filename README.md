<img src="https://github.com/Kimseungyeon98/MediChat/blob/main/MediChat/src/main/resources/static/images/logo.png?raw=true" width="660px" height="210px">
프로젝트 발표 자료: [MediChat.pdf](https://github.com/user-attachments/files/16538635/MediChat.pdf)

# 프로젝트 이름
> ***MediChat(메디챗)***
> 

# 프로젝트 소개
> 환자와 의료 전문가 간에 원활한 비대면 의료 서비스를 제공하는 웹사이트.
> 환자들이 병원 외부에서도, 의료 관련 서비스를 안전하고 효율적으로 받을 수 있도록 설계하였으며, 편리하고 신뢰할 수 있는 빈대면 진료 경험을 제공한다.
> 
>> ![KakaoTalk_20241115_004551913](https://github.com/user-attachments/assets/e895d0b3-392f-4b98-8acd-a5d8a02ef7e4)

# 프로젝트 기간
> 2024.07.01 ~ 2024.07.31
> 

# 참여 인원
> |***김승연(조장)***|김유진|김찬윤|손소희|송효기|원혜리|윤찬호|
> |---|---|---|---|---|---|---|
> |병원 찾기|비대면 진료 결제|일반 회원 관리|건강 블로그|비대면 진료 예약|의약품 백과사전|MyPage|
> |약국 찾기|비대면 진료 채팅|의사 회원 관리|질병 백과사전|의사 회원 관리(휴무 관리)|||
> |공공API 데이터 적재|진료 기록 관리|소셜 로그인|커뮤니티||||
> |실시간 의료 상담|||||||
> |공통 알림 기능|||||||
> 

# 사용 기술
> ## 협업 툴
 >> Notion (문서 관리)
> > 
 >> Kakao Oven (UI 설계)
> > 
 >> ERD Cloud (DB 설계)
> > 
>## IDE
 >> Eclipse
> > 
>## 프론트
 >> HTML
> > 
 >> CSS
> > 
 >> JAVASCRIPT
> >
 >> JSP
> >
 >> jQuery
> >
 >> Ajax
> > 
>## 백엔드
 >> JAVA8
> >
 >> MyBatis
> >
 >> WebSocket
> > 
>## DB
 >> Oracle
> >
>## API
 >> 공공 Data API(SafeMap)
> >
 >> KAKAO MAP API
> >
 >> FullCalendar API
> >
 >> Import API
> >
 >> Social Login API(KAKAO, NAVER)
> > 

# ERD
> ![그림1](https://github.com/user-attachments/assets/86910bfb-6cb1-474c-8dea-13f7871174a5)
> ![그림2](https://github.com/user-attachments/assets/f0b59d18-8bfa-4f4c-a42a-d4d2a9036c18)
>



# 트러블슈팅
> 1. 쿼리 튜닝
>> 병원 목록을 조회하기 위해 여러 조건 또는 검색값 등으로 조건 처리하고, 클라이언트의 위치에 따라 동적으로 조회하는 쿼리를 짰습니다.
>> 문제는 조금씩 기능을 추가하다 보니 동적 조건이 많아져 조회 속도가 약 3.5sec로 너무 느려졌다는 점이었습니다.
>> 
>> 이 문제를 해결하기 위해 첫번째로 인덱스를 활용할 수 있는지 확인해봤습니다.
>> 하지만 클라이언트의 위치에 따라 동적으로 연산되어 만들어지는 거리값이기 때문에 인덱싱이 불가했습니다.
>>
>> 다음으로는 불필요한 조인이나 서브쿼리가 있는지 확인하고 쿼리를 축소시켰습니다. 그 결과 **3.5sec -> 3.3sec** 로 단축이 가능했습니다.
>>
>> 여전히 느렸기 때문에 서브쿼리를 분리해 따로 살펴보거나 실행계획을 공부해보는 등 병목을 찾기 시작했습니다.
>> 예상했던 연산 과정에서의 시간 지체가 아닌 연산이 완료되고 정렬하는 과정에서 시간이 많이 지체된다는 점을 발견했습니다.
>> 정렬 대상이 되는 레코드 수를 줄이기 위해 다양한 조건 처리를 추가 했고 그 결과 **3.3sec -> 2.5sec** 로 단축 성공했습니다.
>> 
>> 아직도 여전히 느렸기 때문에 두 가지 방법을 고안했습니다.
>>
>> 첫번째는 병원 정보에 담겨있는 지역명 정보를 활용해 연산 대상이되는 레코드 수를 줄여 연산, 정렬 두 과정 모두 단축하는 방법이었습니다.
>> 결과적으로 **2.5sec -> 0.5sec**로 단축 성공했으나, 해당 지역에 인접한 다른 지역의 병원 검색을 위해 더 많은 조건 처리를 해야한다는 점과 지역명 정보를 변수로 사용하기 위해 조회를 두 번 해야 한다는 점.
>> 이 두 가지 이유 때문에 첫번째 방법은 채택하지 않았습니다.
>> 
>> 두번째는 위도 경도값의 범위를 지정해 연산, 정렬 두 과정 모두 단축하는 방법이었습니다.
>> 1km당 위도 경도의 차이가 0.008정도라 가정하고 약 5km 범위 내의 병원 정보를 조회하기 위해 위도 경도의 차이가 0.04 이내인 값을 조회하여 연산하고 정렬하도록 조건 처리를 했습니다.
>> 그 결과 **2.5sec -> 0.04sec**로 단축 성공했고 첫 번째 방법보다 변경요소가 적다고 판단되어 채택하게 되었습니다.
>> 
> 2. 검색 정확도
>> 초기에 병원 검색기능은 병원의 이름 or 지역명 or 진료과목 3가지 키워드로 검색이 가능했습니다.
>> 저는 추가적으로 질병 이름 또는 질병의 증상으로도 정확도 높게 병원 검색이 가능하게 만들고 싶었습니다.
>> 예를 들어 '기침'을 검색하면 가장 연관도 높은 '감기'라는 질병을 진료 가능한 '이비인후과'에 해당하는 병원들이 검색가능하도록 만들고 싶었습니다.
>> 따라서 저는 질병의 이름, 증상, 연관된 진료 과목이 포함된 공공API 데이터를 활용했습니다.
>>
>> 검색 결과가 질병의 이름에 포함되거나 질병의 증상에 포함된다면 해당 진료과목을 중복 없이 조회하여 조회된 진료과목에 해당하는 병원들을 목록에 추가하여 조회하도록 했습니다.
>> 하지만 질병이 포함하는 진료과목의 데이터가 예상보다 광범위하게 포함되어 있어 단순히 '기침'을 검색하게 되면 모든 진료과목이 포함된 검색 결과를 얻게 되어 오히려 검색 정확도가 떨어지는 문제가 발생했습니다.
>>
>> 문제를 해결하기 위해 Distinct가 아닌 Group By와 Count를 활용해 진료과목이 조회된 횟수를 조회했고 그 중 2가지의 진료과목만 상위 검색 결과에 포함되게 구현했습니다.
>> 그 결과 검색 정확도가 구현 초기 예상했던 정확도에 미치는 결과를 자아냈습니다.
>> 

# 회고 / 느낀 점
> 처음으로 꽤 많은 양의 데이터를 다뤄봤습니다.
> 단순하게 쿼리를 짜게 되면 조회속도가 현저히 느려질 수 있다는 점을 경험하게 되었습니다.
>
> 또한 기능의 확장성을 위해 초기 구현을 대충하면 안된다는 점을 뼈저리게 깨닫게 되는 프로젝트였습니다.
> 기획된 기능 이외의 기능을 추가하다 보니 초기에 구현해놓은 메서드를 수정할 때면 나 자신을 원망하게 되는 순간들이 많았습니다.
> 이 점은 프로젝트의 공통 기능을 구현할 때에도 느끼게 되었습니다. 내가 구현한 공통 기능을 다른 팀원들에게 명세서를 제작 해줘야하는 상황에서 조금 더 범용성 좋게, 가독성 좋게 만들껄 하는 후회를 하며 구현을 대충하지 말자는 생각을 했습니다.
> 앞으로 어렵겠지만 확장성을 고려하여 변수명, 메서드명, 애노테이션 등 여러 변수를 고려하여 구현할 수 있도록 해야겠다 다짐했습니다.
